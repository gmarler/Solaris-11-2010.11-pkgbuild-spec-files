--- a/Makefile.am
+++ b/Makefile.am
@@ -1,3 +1,5 @@
+ACLOCAL_AMFLAGS = -I build/autotools
+
 SUBDIRS = clutter-gtk doc examples
 
 clutter-gtk-0.9.pc: clutter-gtk.pc
@@ -10,6 +12,6 @@ CLEANFILES = clutter-gtk-0.9.pc
 
 DISTCLEANFILES = clutter-gtk.pc
 
-EXTRA_DIST = clutter-gtk.pc.in
+EXTRA_DIST = clutter-gtk.pc.in introspection.m4
 
 DISTCHECK_CONFIGURE_FLAGS = --enable-gtk-doc
diff --git a/autogen.sh b/autogen.sh
index aecfb84..c792397 100755
--- a/autogen.sh
+++ b/autogen.sh
@@ -1,4 +1,4 @@
 #! /bin/sh
 gtkdocize || exit 1
-autoreconf -v --install || exit 1
+env ACLOCAL="${ACLOCAL-aclocal} $ACLOCAL_FLAGS"  autoreconf -v --install || exit 1
 ./configure --enable-maintainer-mode "$@"
diff --git a/build/autotools/introspection.m4 b/build/autotools/introspection.m4
new file mode 100644
index 0000000..bb3a0da
--- /dev/null
+++ b/build/autotools/introspection.m4
@@ -0,0 +1,88 @@
+dnl -*- mode: autoconf -*-
+dnl Copyright 2009 Johan Dahlin
+dnl
+dnl This file is free software; the author(s) gives unlimited
+dnl permission to copy and/or distribute it, with or without
+dnl modifications, as long as this notice is preserved.
+dnl
+
+# serial 1
+
+m4_define([_GOBJECT_INTROSPECTION_CHECK_INTERNAL],
+[
+    AC_BEFORE([AC_PROG_LIBTOOL],[$0])dnl setup libtool first
+    AC_BEFORE([AM_PROG_LIBTOOL],[$0])dnl setup libtool first
+    AC_BEFORE([LT_INIT],[$0])dnl setup libtool first
+
+    dnl enable/disable introspection
+    m4_if([$2], [require],
+    [dnl
+        enable_introspection=yes
+    ],[dnl
+        AC_ARG_ENABLE(introspection,
+                  AS_HELP_STRING([--enable-introspection[=@<:@no/auto/yes@:>@]],
+                                 [Enable introspection for this build]),,
+                                 [enable_introspection=auto])
+    ])dnl
+
+    AC_MSG_CHECKING([for gobject-introspection])
+
+    dnl presence/version checking
+    AS_CASE([$enable_introspection],
+    [no], [dnl
+        found_introspection="no (disabled, use --enable-introspection to enable)"
+    ],dnl
+    [yes],[dnl
+        PKG_CHECK_EXISTS([gobject-introspection-1.0],,
+                         AC_MSG_ERROR([gobject-introspection-1.0 is not installed]))
+        PKG_CHECK_EXISTS([gobject-introspection-1.0 >= $1],
+                         found_introspection=yes,
+                         AC_MSG_ERROR([You need to have gobject-introspection >= $1 installed to build AC_PACKAGE_NAME]))
+    ],dnl
+    [auto],[dnl
+        PKG_CHECK_EXISTS([gobject-introspection-1.0 >= $1], found_introspection=yes, found_introspection=no)
+    ],dnl
+    [dnl
+        AC_MSG_ERROR([invalid argument passed to --enable-introspection, should be one of @<:@no/auto/yes@:>@])
+    ])dnl
+
+    AC_MSG_RESULT([$found_introspection])
+
+    INTROSPECTION_SCANNER=
+    INTROSPECTION_COMPILER=
+    INTROSPECTION_GENERATE=
+    INTROSPECTION_GIRDIR=
+    INTROSPECTION_TYPELIBDIR=
+    if test "x$found_introspection" = "xyes"; then
+       INTROSPECTION_SCANNER=`$PKG_CONFIG --variable=g_ir_scanner gobject-introspection-1.0`
+       INTROSPECTION_COMPILER=`$PKG_CONFIG --variable=g_ir_compiler gobject-introspection-1.0`
+       INTROSPECTION_GENERATE=`$PKG_CONFIG --variable=g_ir_generate gobject-introspection-1.0`
+       INTROSPECTION_GIRDIR=`$PKG_CONFIG --variable=girdir gobject-introspection-1.0`
+       INTROSPECTION_TYPELIBDIR="$($PKG_CONFIG --variable=typelibdir gobject-introspection-1.0)"
+    fi
+    AC_SUBST(INTROSPECTION_SCANNER)
+    AC_SUBST(INTROSPECTION_COMPILER)
+    AC_SUBST(INTROSPECTION_GENERATE)
+    AC_SUBST(INTROSPECTION_GIRDIR)
+    AC_SUBST(INTROSPECTION_TYPELIBDIR)
+
+    AM_CONDITIONAL(HAVE_INTROSPECTION, test "x$found_introspection" = "xyes")
+])
+
+
+dnl Usage:
+dnl   GOBJECT_INTROSPECTION_CHECK([minimum-g-i-version])
+
+AC_DEFUN([GOBJECT_INTROSPECTION_CHECK],
+[
+  _GOBJECT_INTROSPECTION_CHECK_INTERNAL([$1])
+])
+
+dnl Usage:
+dnl   GOBJECT_INTROSPECTION_REQUIRE([minimum-g-i-version])
+
+
+AC_DEFUN([GOBJECT_INTROSPECTION_REQUIRE],
+[
+  _GOBJECT_INTROSPECTION_CHECK_INTERNAL([$1], [require])
+])
diff --git a/clutter-gtk/Makefile.am b/clutter-gtk/Makefile.am
index 1f487e0..83b8aae 100644
--- a/clutter-gtk/Makefile.am
+++ b/clutter-gtk/Makefile.am
@@ -1,3 +1,4 @@
+CLEANFILES=
 INCLUDES = \
 	-I$(srcdir) 				\
 	-I$(top_srcdir) 			\
@@ -10,10 +11,11 @@ INCLUDES = \
         -DGDK_DISABLE_DEPRECATED                \
         -DGTK_DISABLE_DEPRECATED                \
 	$(CLUTTER_DEBUG_FLAGS) 			\
-	$(GCC_FLAGS) 				\
 	$(CLUTTER_CFLAGS) 			\
 	$(GTK_CFLAGS)
 
+AM_CFLAGS = $(GCC_FLAGS)
+
 lib_LTLIBRARIES = libclutter-gtk-0.9.la
 
 # please, keep the list sorted alphabetically
@@ -34,3 +36,33 @@ cluttergtkheaders_HEADERS = \
         gtk-clutter-scrollable.h \
         gtk-clutter-util.h \
         gtk-clutter-viewport.h
+
+if HAVE_INTROSPECTION
+BUILT_GIRSOURCES =
+
+GtkClutter-@CLUTTER_GTK_API_VERSION@.gir: $(INTROSPECTION_SCANNER) libclutter-gtk-0.9.la
+	$(INTROSPECTION_SCANNER) -v --namespace GtkClutter --nsversion=@CLUTTER_GTK_API_VERSION@ \
+	     $(INCLUDES) \
+             --include=Clutter-@CLUTTER_GTK_API_VERSION@ \
+             --include=Gtk-2.0 \
+	     --library=clutter-gtk-@CLUTTER_GTK_API_VERSION@ \
+	     --libtool="$(LIBTOOL)" \
+             --output $@ \
+	     $(cluttergtkheaders_HEADERS) \
+             $(libclutter_gtk_0_9_la_SOURCES)
+
+BUILT_GIRSOURCES += GtkClutter-@CLUTTER_GTK_API_VERSION@.gir
+
+# INTROSPECTION_GIRDIR/INTROSPECTION_TYPELIBDIR aren't the right place to install
+# thing - we need to install inside our prefix.
+girdir = $(datadir)/gir-1.0
+gir_DATA = $(BUILT_GIRSOURCES)
+
+typelibsdir = $(libdir)/girepository-1.0/
+typelibs_DATA = $(BUILT_GIRSOURCES:.gir=.typelib)
+
+%.typelib: %.gir $(INTROSPECTION_COMPILER)
+	$(DEBUG) $(INTROSPECTION_COMPILER) --includedir=$(srcdir) --includedir=. $(INTROSPECTION_COMPILER_OPTS) $< -o $(builddir)/$(@F)
+
+CLEANFILES += $(BUILT_GIRSOURCES) $(typelibs_DATA)
+endif
diff --git a/configure.ac b/configure.ac
index fe4de51..e3fef20 100644
--- a/configure.ac
+++ b/configure.ac
@@ -21,6 +21,7 @@ AC_PREREQ(2.53)
 AC_INIT([clutter-gtk],
         [clutter_version],
         [http://bugzilla.o-hand.com/enter_bug.cgi?product=Clutter])
+AC_CONFIG_MACRO_DIR([build/autotools])
 AC_CONFIG_SRCDIR([clutter-gtk/gtk-clutter-embed.h])
 AM_CONFIG_HEADER([config.h])
 
@@ -29,10 +30,12 @@ AM_INIT_AUTOMAKE([1.9])
 CLUTTER_GTK_MAJOR_VERSION=clutter_major_version
 CLUTTER_GTK_MINOR_VERSION=clutter_minor_version
 CLUTTER_GTK_MICRO_VERSION=clutter_micro_version
+CLUTTER_GTK_API_VERSION=clutter_api_version
 CLUTTER_GTK_VERSION=clutter_version
 AC_SUBST(CLUTTER_GTK_MAJOR_VERSION)
 AC_SUBST(CLUTTER_GTK_MINOR_VERSION)
 AC_SUBST(CLUTTER_GTK_MICRO_VERSION)
+AC_SUBST(CLUTTER_GTK_API_VERSION)
 AC_SUBST(CLUTTER_GTK_VERSION)
 
 m4_define([lt_current],
@@ -100,6 +103,8 @@ PKG_CHECK_MODULES(GTK, gtk+-2.0 >= 2.12)
 AC_SUBST(GTK_CFLAGS)
 AC_SUBST(GTK_LIBS)
 
+GOBJECT_INTROSPECTION_CHECK([0.6.3])
+
 dnl ========================================================================
 
 if test "x$GCC" = "xyes"; then
-- 
1.6.0.6

